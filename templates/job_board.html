{% extends "base.html" %}

{% block title %}Job Board{% endblock %}

{% block content %}
    <h1>Job Board</h1>
<!-- Job Search Form -->
<form action="{{ url_for('job_board') }}" method="post">
    {{ job_search_form.csrf_token }}
    
    <div class="form-group">
        {{ job_search_form.city.label(class="form-control-label") }}
        {{ job_search_form.city(class="form-control") }}
    </div>

    <div class="form-group">
        {{ job_search_form.state.label(class="form-control-label") }}
        {{ job_search_form.state(class="form-control") }}
    </div>
    
    <div class="form-group">
        {{ job_search_form.keyword.label(class="form-control-label") }}
        {{ job_search_form.keyword(class="form-control") }}
    </div>

    <button type="submit" class="btn btn-primary">Search</button>
</form>


    {% if get_flashed_messages() %}
        <div class="flash-messages">
            {% for message in get_flashed_messages() %}
                <div class="flash-message">{{ message }}</div>
            {% endfor %}
        </div>
    {% endif %}

    {% if web_job_data %}
        <h2>Web Job Data</h2>
        <ul>
            {% for job in web_job_data %}
                <li>
                    <h3>{{ job['Title'] }}</h3>
                    <p><strong>Location:</strong> {{ job['Location'] }}</p>
                    <p><strong>City:</strong> {{ job.City }}</p>
                    <p><strong>State:</strong> {{ job.State }}</p>
                    <p><strong>Base Pay:</strong> {{ job['Base Pay'] }}</p>
                    <p><strong>Duties:</strong></p>
                    <ul>
                        {% for duty in job['Duties'] %}
                            <li>{{ duty }}</li>
                        {% endfor %}
                    </ul>
                    <!-- Add a link for web job details here -->
                    <a href="{{ url_for('accept_job', username=g.user.username, job_id=loop.index) }}">Accept Job</a>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>No web job data available.</p>
    {% endif %}

    {% if matched_jobs %}
        <h2>Database Job Data</h2>
        <ul>
            {% for job in matched_jobs %}
                <li>
                    <h3>{{ job.job_title }}</h3>
                    <p><strong>Location:</strong> {{ job.job_city }}, {{ job.job_state }}</p>
                    <p><strong>Base Pay:</strong> {{ job.job_payrate }}</p>
                    <p><strong>Duties:</strong></p>
                    <ul>
                        {% for duty in job.job_duties.split(',') %}
                            <li>{{ duty }}</li>
                        {% endfor %}
                    </ul>
                    <!-- Add a link for database job details here -->
                    <a href="{{ url_for('accept_job', username=g.user.username, job_id=job.id) }}">Accept Job</a>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>No matching job data available.</p>
    {% endif %}
{% endblock %}
